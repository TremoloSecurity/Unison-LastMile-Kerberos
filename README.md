# Unison-LastMile-Kerberos
This filter provides a LastMile implementation using Kerberos' S4U2Self and S4U2Proxy extensions to allow for SSO into any Kerberos enabled application.  

## Prerequisites
Before deploying this filter, you will need to:

1. Create a service account and keytab (see the process below for either IPA or Active Directory)
2. Make sure that Unison is running on Java 8 (NOT Java 1.7)
3. Make sure the box running Unison is a member of the domain (varies based on if IPA or Active Directory is being used)

## Configuration Options
The below configuraiton options are all required:

* uidAttributeName - The name of the attribute from the logged in user that corresponds to the user login id (uid in IPA or samAccountName in Active Directory)
* targetServicePrincipal - The full kerberos principal that will consume the service granting ticket (ie HTTP/myhos.mydomain.com@MYDOMAIN.COM)
* keytabPath - The full path to the keytab file on the unison server (ie /usr/local/tremolo/tremolo-service/ext-lib/mykeytab.kt)
* keytabPrincipal - The full kerberos principal provided by the keytab file (ie HTTP/unison.mydomain.com@MYDOMAIN.COM)

## Build

The project is built using Maven.  Make sure that the JDK being used by Maven is Java 8 or above.

## Deploy

1. After building, deploy `target/unison-lastmile-kerberos-1.0.7.jar` to your Unison server's classpath
2. Join the Unison server to the domain, making sure the /etc/krb5.conf is properly configured
3. Make sure that Unison is using the same DNS servers as the domain
4. Add the `com.tremolosecurity.unison.proxy.lastmile.kerberos.KerberosLastMile` filter in front of your application with the above configuration information

No additional libraries are required.

## Generating a Service Account and KeyTab

In order to create the trust between Unison and your application you must tell your Kerberos environment to trust tickets generated by Unison.  

### FreeIPA / Red Hat Identity Management

### Active Directory
